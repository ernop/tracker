{% extends 'jinja2/day_base.html' %}
{% block title %}{{day}}{% endblock %}
{% block head %}
    {{super()}}
    <script src='/static/js/day_funcs.js'></script>
    <script src='/static/js/recordmp3.js'></script>
    <script src='/static/js/recording_helpers.js'></script>
    <script src='/static/js/day.js'></script>
    <script>
        var today={{today|jsonify|safe}};
        var notekinds={{notekinds|jsonify|safe}};
        var full_notekinds={{full_notekinds|jsonify|safe}};
        var products={{products|jsonify|safe}};
        var sources={{sources|jsonify|safe}};
        var people={{people|jsonify|safe}};
        var currencies={{currencies|jsonify|safe}};
        var hours={{hours|jsonify|safe}};
        var hour={{hour|jsonify|safe}};
        var measurement_spots={{measurement_spots|jsonify|safe}};
        var day_id={{day.id}};
        var noteids={{noteids|jsonify|safe}}
        $(document).ready(function(){
            $(".hoverable").popover({trigger:'hover',placement:'bottom'})
        })
    </script>
    <style>
    .container{width:90%;}
    .popover{max-width:500px;}
    .popover-content{18px;}
    .note-outline{display:inline-block;width:90%;padding-bottom:18px;}
    .notekindzone{margin-left:15px;display:inline-block;}
    .note-row{font-size:18px;line-height:18px;}
    .redborder{border:3px solid red;border-radius:4px;}
    </style>
{% endblock %}

{% block content %}
{% if LOCAL %}<a class="btn-default btn" href="http://tracker{{path}}" target=_blank>live</a>{% endif %}
<div class="row">
    <div>
        <h2>{{day.date}} {{day.show_day()}}</h2>
        {% set dayphotos = day.get_day_taken_photos(user) %}
        {% if dayphotos %}
            <div class="historybox">
            {% for photo in dayphotos %}
                {% if loop.counter==0%}Today{%endif %}
                <div class="photolink">{{photo.inhtml(size='thumb',ajaxlink=True)|safe}}</div>
            {% endfor %}
            </div>
        {% endif %}
        
        {% for historyday in histories %}
            <div class="historybox">
            <span class="float:left;">{{historyday.hoverblock()|safe}}</span>
            {% set taken_photos=historyday.get_day_taken_photos(user)%}
            {% if taken_photos%}
                {% for photo in taken_photos %}
                    <div class="photolink">{{photo.inhtml(size='thumb',ajaxlink=True)|safe}}</div>
                {% endfor %}
            {% endif %}
            </div>
            <div class="saved-day-box">
                {% set created_photos=historyday.get_day_created_photos(user)%}
                {% if created_photos%}
                    {% for photo in created_photos %}
                        <div class="photolink">{{photo.inhtml(size='thumb',ajaxlink=True)|safe}}</div>
                    {% endfor %}
                {% endif %}
            </div>
        {% endfor %}

    </div>
</div>

{% include "jinja2/noteblock.html" %}


<div class="noteouter">
    <div class="span2" style="float:left;">
        <div class="add-note btn btn-default">
            <span class="glyphicon glyphicon-plus"></span>
        </div>
    </div>
    <a href="/admin/day/notekind/add" class="btn btn-default"><span class="glyphicon glyphicon-plus"></span>add notekind</a>
    <div class="notezone">
    </div>
</div>


<div>
    <h2>Purchases</h2>
    <table class="purchase-list table"></table>
    <div class="purchase-zone span12">
        <table class="table"><tr>
        <td><input id="purchase-product" style="width:190px;"></input>
        <td style="vertical-align:middle;"><input type=text style="width:30px;" id="purchase-cost"></input> money for
        <input type=text id=purchase-quantity style="width:28px;" value=1></input> guys<a class="btn btn-default" style="margin-left:38px;" href="{{ADMIN_EXTERNAL_BASE}}/day/product/add"><span class="glyphicon glyphicon-plus"></span></a><td><div class="price-chooser"></div>
        <div style="clear:both;float:left;" class="product-chooser"></div>
        <tr><td>source <td><input id="purchase-source" style="width:190px;"></input><a class="btn btn-default" href="{{ADMIN_EXTERNAL_BASE}}/day/source/add"><span class="glyphicon glyphicon-plus"></span></a><td><div class="source-chooser">
        <tr><td>hour<td><input type=text id="purchase-hour" style="width:190px;" value="{{hour}}"></input><td><div class="hour-chooser">
        <tr><td>who<td><input id=purchase-who_with style="width:190px;"></input><a class="btn btn-default" href="{{ADMIN_EXTERNAL_BASE}}/day/person/add"><span class="glyphicon glyphicon-plus"></span></a><td><div class="who_with-chooser">
        
        <tr><td>currency<td><input type=text id=purchase-currency style="width:190px;"></input>
        <tr><td>note<td><input type=text id=purchase-note style="width:180px;"></input>
        <tr><td>size<td><input type=text id=purchase-size  style="width:180px;"></input>
        <tr><td><div class="btn btn-default make-purchase">Save</div>
        <td>
        
        
        </table>
    </div>
</div>

<div class="row">
    <h2>Measurement</h2>
    <div>
    <table class="table thintable measurement-list">
    </table>
    <div class="measurement-zone">
        <table class="table"><tr>
        <tr><td><input  id="measurement-spot" style="width:190px;"></input><td><input type=text id="measurement-amount" style="width:190px;"></input>
        <tr><td><div class="btn btn-default make-measurement">Save</div><td><div class="measurement-loading-zone">&nbsp;</div>
        <tr><td><a class="btn btn-default" href="{{ADMIN_EXTERNAL_BASE}}/day/measurement/add"><span class="glyphicon glyphicon-plus"></span>new</a>
        </table>
    </div>
</div></div>

<div class="row" style='display:none;'><div>
<h2>Workouts</h2>
    {% for workout in day.getworkouts() %}
    {{workout.mysets()|safe}}<br>{% endfor %}
    <a class="btn btn-default" href="{{ADMIN_EXTERNAL_BASE}}/day/day/add"><span class="glyphicon glyphicon-plus"></span> new</a><br>
</div></div>

<div id="notemodel" class="note-outline" style="display:none;">
    <div class="note-row" note_id="new" >
            <textarea class="textarea" id="note" note_id="new" style="float:left;height:100px;"></textarea>
            <div class="notekindzone">
                <div class="notekind-available"></div>
                <button class="notekindselect" value=""></button>
            </div>
    </div>
</div>

<div class="notification fixed-notification">
</div>

{% endblock %}
{% block footer %}{{super()}}{% include "jinja2/dayfooter.html" %}
{% endblock %}